{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/martinadams/Desktop/FLO-OIP projects/DDX/oip-ddx-light/frontend/components/containers/ExplorerContainer.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\n\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\nimport React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport Explorer from '../views/wrappers/Explorer';\nimport { DEFAULT, SEARCH, setMode } from '../../redux/actions/Interface/creators';\nimport { searchRecords, searchTemplates } from '../../redux/actions/Explorer/thunks';\nimport { extendTemplates, publishRecord, publishTemplate } from '../../redux/actions/Publisher/creators';\nvar Records = 'Records';\nvar Templates = 'Templates';\n\nvar ExplorerContainer = function ExplorerContainer(_ref) {\n  _s();\n\n  var defaultRecords = _ref.defaultRecords,\n      defaultTemplates = _ref.defaultTemplates,\n      searchedRecords = _ref.searchedRecords,\n      searchedTemplates = _ref.searchedTemplates,\n      mode = _ref.mode,\n      defaultRecordPage = _ref.defaultRecordPage,\n      defaultTemplatePage = _ref.defaultTemplatePage,\n      searchedRecordPage = _ref.searchedRecordPage,\n      searchedTemplatePage = _ref.searchedTemplatePage,\n      defaultRecordKeys = _ref.defaultRecordKeys,\n      defaultTemplateKeys = _ref.defaultTemplateKeys,\n      searchedRecordKeys = _ref.searchedRecordKeys,\n      searchedTemplateKeys = _ref.searchedTemplateKeys,\n      recordsFetching = _ref.recordsFetching,\n      recordsSuccess = _ref.recordsSuccess,\n      recordsError = _ref.recordsError,\n      templatesFetching = _ref.templatesFetching,\n      templatesSuccess = _ref.templatesSuccess,\n      templatesError = _ref.templatesError,\n      searchRecords = _ref.searchRecords,\n      searchTemplates = _ref.searchTemplates,\n      setMode = _ref.setMode,\n      publishRecord = _ref.publishRecord,\n      publishTemplate = _ref.publishTemplate,\n      extendTemplates = _ref.extendTemplates,\n      daemonApi = _ref.daemonApi,\n      showOnlyVerifiedPublishers = _ref.showOnlyVerifiedPublishers;\n\n  var _useState = useState(''),\n      searchInput = _useState[0],\n      setSearchInput = _useState[1];\n\n  var _useState2 = useState(Records),\n      selectOption = _useState2[0],\n      setSelectOption = _useState2[1];\n\n  function isVerified(_x) {\n    return _isVerified.apply(this, arguments);\n  }\n\n  function _isVerified() {\n    _isVerified = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref2) {\n      var pubAddr, templateName, apiUrl, localhost;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              pubAddr = _ref2.pubAddr, templateName = _ref2.templateName, apiUrl = _ref2.apiUrl, localhost = _ref2.localhost;\n              _context.prev = 1;\n              _context.next = 4;\n              return daemonApi.isVerifiedPublisher({\n                pubAddr: pubAddr,\n                templateName: templateName,\n                apiUrl: apiUrl,\n                localhost: localhost\n              });\n\n            case 4:\n              return _context.abrupt(\"return\", _context.sent);\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](1);\n              console.error(\"Failed to verify pub address: \".concat(pubAddr, \": \\n \").concat(_context.t0));\n              return _context.abrupt(\"return\", {\n                success: false,\n                error: _context.t0\n              });\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 7]]);\n    }));\n    return _isVerified.apply(this, arguments);\n  }\n\n  var _useState3 = useState({}),\n      selectedTemplates = _useState3[0],\n      setSelectedTemplates = _useState3[1];\n\n  function handleSelectTemplate(_ref3) {\n    var id = _ref3.id,\n        template = _ref3.template;\n\n    if (selectedTemplates[id]) {\n      var _ = selectedTemplates[id],\n          newSelection = _objectWithoutProperties(selectedTemplates, [id].map(_toPropertyKey));\n\n      setSelectedTemplates(newSelection);\n    } else {\n      setSelectedTemplates(function (prevState) {\n        return _objectSpread(_objectSpread({}, prevState), {}, _defineProperty({}, id, template));\n      });\n    }\n  }\n\n  function handlePublishRecordWithTemplates() {\n    var templates = [];\n\n    for (var tmpl in selectedTemplates) {\n      if (selectedTemplates.hasOwnProperty(tmpl)) {\n        templates.push(selectedTemplates[tmpl]);\n      }\n    }\n\n    publishRecord(templates);\n  }\n\n  function handleExtendTemplates() {\n    // get template IDs\n    var ids = [];\n\n    for (var tmpl in selectedTemplates) {\n      if (selectedTemplates.hasOwnProperty(tmpl)) {\n        ids.push(selectedTemplates[tmpl].identifier);\n      }\n    }\n\n    publishTemplate();\n    extendTemplates(ids);\n  }\n\n  function handleSearchInput(e) {\n    setSearchInput(e.target.value);\n  }\n\n  function handleSelectOption(e) {\n    setSelectOption(e.target.value);\n  }\n\n  function handleSearchSubmit() {\n    if (searchInput === '') {\n      setMode(DEFAULT);\n    } else {\n      if (selectOption === Records) {\n        setMode(SEARCH);\n        searchRecords(searchInput);\n      }\n\n      if (selectOption === Templates) {\n        setMode(SEARCH);\n        searchTemplates(searchInput);\n      }\n    }\n  }\n\n  var records, templates;\n\n  if (mode === DEFAULT) {\n    records = defaultRecords;\n    var recordKey = defaultRecordKeys[defaultRecordPage];\n    records = records[recordKey];\n    templates = defaultTemplates;\n    var templateKey = defaultTemplateKeys[defaultTemplatePage];\n    templates = templates[templateKey];\n  } else if (mode === SEARCH) {\n    records = searchedRecords;\n    var _recordKey = searchedRecordKeys[searchedRecordPage];\n    records = records[_recordKey];\n    templates = searchedTemplates;\n    var _templateKey = searchedTemplateKeys[searchedTemplatePage];\n    templates = templates[_templateKey];\n  }\n\n  return __jsx(Explorer, {\n    records: records,\n    templates: templates,\n    searchInput: searchInput,\n    selectOption: selectOption,\n    handleSearchInput: handleSearchInput,\n    handleSelectOption: handleSelectOption,\n    handleSearchSubmit: handleSearchSubmit,\n    recordsFetching: recordsFetching,\n    recordsSuccess: recordsSuccess,\n    recordsError: recordsError,\n    templatesFetching: templatesFetching,\n    templatesSuccess: templatesSuccess,\n    templatesError: templatesError,\n    publishRecord: publishRecord,\n    publishTemplate: publishTemplate,\n    extendTemplates: extendTemplates,\n    handleSelectTemplate: handleSelectTemplate,\n    selectedTemplates: selectedTemplates,\n    handlePublishRecordWithTemplates: handlePublishRecordWithTemplates,\n    handleExtendTemplates: handleExtendTemplates,\n    isVerified: isVerified,\n    showOnlyVerifiedPublishers: showOnlyVerifiedPublishers,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 10\n    }\n  });\n};\n\n_s(ExplorerContainer, \"v3yN26mbbviiXrIQL3NuMkPygyA=\");\n\n_c = ExplorerContainer;\n\nfunction mapStateToProps(state) {\n  // toDo: note:: separate templates and records\n  return {\n    daemonApi: state.Explorer.daemonApi,\n    defaultRecords: state.Explorer.defaultRecords,\n    defaultTemplates: state.Explorer.defaultTemplates,\n    searchedRecords: state.Explorer.searchedRecords,\n    searchedTemplates: state.Explorer.searchedTemplates,\n    mode: state.Interface.mode,\n    defaultRecordPage: state.Interface.defaultRecordPage,\n    defaultTemplatePage: state.Interface.defaultTemplatePage,\n    searchedRecordPage: state.Interface.searchedRecordPage,\n    searchedTemplatePage: state.Interface.searchedTemplatePage,\n    defaultRecordKeys: state.Explorer.defaultRecordKeys,\n    defaultTemplateKeys: state.Explorer.defaultTemplateKeys,\n    searchedRecordKeys: state.Explorer.searchedRecordKeys,\n    searchedTemplateKeys: state.Explorer.searchedTemplateKeys,\n    recordsFetching: state.Explorer.recordsFetching,\n    recordsSuccess: state.Explorer.recordsSuccess,\n    recordsError: state.Explorer.recordsError,\n    templatesFetching: state.Explorer.templatesFetching,\n    templatesSuccess: state.Explorer.templatesSuccess,\n    templatesError: state.Explorer.templatesError,\n    showOnlyVerifiedPublishers: state.Interface.showOnlyVerifiedPublishers\n  };\n}\n\nvar mapDispatchToProps = {\n  setMode: setMode,\n  searchRecords: searchRecords,\n  searchTemplates: searchTemplates,\n  publishRecord: publishRecord,\n  publishTemplate: publishTemplate,\n  extendTemplates: extendTemplates\n};\nExplorerContainer.propTypes = {\n  daemonApi: PropTypes.object.isRequired,\n  setMode: PropTypes.func.isRequired,\n  searchRecords: PropTypes.func.isRequired,\n  searchTemplates: PropTypes.func.isRequired,\n  defaultRecords: PropTypes.object,\n  defaultTemplates: PropTypes.object,\n  searchedRecords: PropTypes.object,\n  searchedTemplates: PropTypes.object,\n  mode: PropTypes.string.isRequired,\n  defaultRecordPage: PropTypes.number,\n  defaultTemplatePage: PropTypes.number,\n  searchedRecordPage: PropTypes.number,\n  searchedTemplatePage: PropTypes.number,\n  defaultRecordKeys: PropTypes.array,\n  defaultTemplateKeys: PropTypes.array,\n  searchedRecordKeys: PropTypes.array,\n  searchedTemplateKeys: PropTypes.array,\n  recordsFetching: PropTypes.bool,\n  recordsSuccess: PropTypes.bool,\n  recordsError: PropTypes.bool,\n  templatesFetching: PropTypes.bool,\n  templatesSuccess: PropTypes.bool,\n  templatesError: PropTypes.bool,\n  publishRecord: PropTypes.func.isRequired,\n  publishTemplate: PropTypes.func.isRequired,\n  extendTemplates: PropTypes.func.isRequired\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(ExplorerContainer);\n\nvar _c;\n\n$RefreshReg$(_c, \"ExplorerContainer\");","map":{"version":3,"sources":["/Users/martinadams/Desktop/FLO-OIP projects/DDX/oip-ddx-light/frontend/components/containers/ExplorerContainer.js"],"names":["React","useState","PropTypes","connect","Explorer","DEFAULT","SEARCH","setMode","searchRecords","searchTemplates","extendTemplates","publishRecord","publishTemplate","Records","Templates","ExplorerContainer","defaultRecords","defaultTemplates","searchedRecords","searchedTemplates","mode","defaultRecordPage","defaultTemplatePage","searchedRecordPage","searchedTemplatePage","defaultRecordKeys","defaultTemplateKeys","searchedRecordKeys","searchedTemplateKeys","recordsFetching","recordsSuccess","recordsError","templatesFetching","templatesSuccess","templatesError","daemonApi","showOnlyVerifiedPublishers","searchInput","setSearchInput","selectOption","setSelectOption","isVerified","pubAddr","templateName","apiUrl","localhost","isVerifiedPublisher","console","error","success","selectedTemplates","setSelectedTemplates","handleSelectTemplate","id","template","_","newSelection","prevState","handlePublishRecordWithTemplates","templates","tmpl","hasOwnProperty","push","handleExtendTemplates","ids","identifier","handleSearchInput","e","target","value","handleSelectOption","handleSearchSubmit","records","recordKey","templateKey","mapStateToProps","state","Interface","mapDispatchToProps","propTypes","object","isRequired","func","string","number","array","bool"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport Explorer from '../views/wrappers/Explorer'\n\nimport {\n  DEFAULT,\n  SEARCH,\n  setMode\n} from '../../redux/actions/Interface/creators'\nimport { searchRecords, searchTemplates } from '../../redux/actions/Explorer/thunks'\nimport { extendTemplates, publishRecord, publishTemplate } from '../../redux/actions/Publisher/creators'\n\nconst Records = 'Records'\nconst Templates = 'Templates'\n\nconst ExplorerContainer = ({\n  defaultRecords,\n  defaultTemplates,\n  searchedRecords,\n  searchedTemplates,\n  mode,\n  defaultRecordPage,\n  defaultTemplatePage,\n  searchedRecordPage,\n  searchedTemplatePage,\n  defaultRecordKeys,\n  defaultTemplateKeys,\n  searchedRecordKeys,\n  searchedTemplateKeys,\n  recordsFetching,\n  recordsSuccess,\n  recordsError,\n  templatesFetching,\n  templatesSuccess,\n  templatesError,\n  searchRecords,\n  searchTemplates,\n  setMode,\n  publishRecord,\n  publishTemplate,\n  extendTemplates,\n  daemonApi,\n  showOnlyVerifiedPublishers\n}) => {\n  const [searchInput, setSearchInput] = useState('')\n  const [selectOption, setSelectOption] = useState(Records)\n\n  async function isVerified ({ pubAddr, templateName, apiUrl, localhost }) {\n    try {\n      return await daemonApi.isVerifiedPublisher({ pubAddr, templateName, apiUrl, localhost })\n    } catch (err) {\n      console.error(`Failed to verify pub address: ${pubAddr}: \\n ${err}`)\n      return { success: false, error: err }\n    }\n  }\n\n  const [selectedTemplates, setSelectedTemplates] = useState({})\n\n  function handleSelectTemplate ({ id, template }) {\n    if (selectedTemplates[id]) {\n      let { [id]: _, ...newSelection } = selectedTemplates\n      setSelectedTemplates(newSelection)\n    } else {\n      setSelectedTemplates(prevState => {\n        return {\n          ...prevState,\n          [id]: template\n        }\n      })\n    }\n  }\n\n  function handlePublishRecordWithTemplates () {\n    let templates = []\n    for (let tmpl in selectedTemplates) {\n      if (selectedTemplates.hasOwnProperty(tmpl)) {\n        templates.push(selectedTemplates[tmpl])\n      }\n    }\n    publishRecord(templates)\n  }\n\n  function handleExtendTemplates () {\n    // get template IDs\n    let ids = []\n    for (let tmpl in selectedTemplates) {\n      if (selectedTemplates.hasOwnProperty(tmpl)) {\n        ids.push(selectedTemplates[tmpl].identifier)\n      }\n    }\n    publishTemplate()\n    extendTemplates(ids)\n  }\n\n  function handleSearchInput (e) {\n    setSearchInput(e.target.value)\n  }\n\n  function handleSelectOption (e) {\n    setSelectOption(e.target.value)\n  }\n\n  function handleSearchSubmit () {\n    if (searchInput === '') {\n      setMode(DEFAULT)\n    } else {\n      if (selectOption === Records) {\n        setMode(SEARCH)\n        searchRecords(searchInput)\n      }\n      if (selectOption === Templates) {\n        setMode(SEARCH)\n        searchTemplates(searchInput)\n      }\n    }\n  }\n\n  let records, templates\n  if (mode === DEFAULT) {\n    records = defaultRecords\n    const recordKey = defaultRecordKeys[defaultRecordPage]\n    records = records[recordKey]\n\n    templates = defaultTemplates\n    const templateKey = defaultTemplateKeys[defaultTemplatePage]\n    templates = templates[templateKey]\n  } else if (mode === SEARCH) {\n    records = searchedRecords\n    const recordKey = searchedRecordKeys[searchedRecordPage]\n    records = records[recordKey]\n\n    templates = searchedTemplates\n    const templateKey = searchedTemplateKeys[searchedTemplatePage]\n    templates = templates[templateKey]\n  }\n\n  return <Explorer\n    records={records}\n    templates={templates}\n    searchInput={searchInput}\n    selectOption={selectOption}\n    handleSearchInput={handleSearchInput}\n    handleSelectOption={handleSelectOption}\n    handleSearchSubmit={handleSearchSubmit}\n    recordsFetching={recordsFetching}\n    recordsSuccess={recordsSuccess}\n    recordsError={recordsError}\n    templatesFetching={templatesFetching}\n    templatesSuccess={templatesSuccess}\n    templatesError={templatesError}\n    publishRecord={publishRecord}\n    publishTemplate={publishTemplate}\n    extendTemplates={extendTemplates}\n    handleSelectTemplate={handleSelectTemplate}\n    selectedTemplates={selectedTemplates}\n    handlePublishRecordWithTemplates={handlePublishRecordWithTemplates}\n    handleExtendTemplates={handleExtendTemplates}\n    isVerified={isVerified}\n    showOnlyVerifiedPublishers={showOnlyVerifiedPublishers}\n  />\n}\n\nfunction mapStateToProps (state) { // toDo: note:: separate templates and records\n  return {\n    daemonApi: state.Explorer.daemonApi,\n    defaultRecords: state.Explorer.defaultRecords,\n    defaultTemplates: state.Explorer.defaultTemplates,\n    searchedRecords: state.Explorer.searchedRecords,\n    searchedTemplates: state.Explorer.searchedTemplates,\n    mode: state.Interface.mode,\n    defaultRecordPage: state.Interface.defaultRecordPage,\n    defaultTemplatePage: state.Interface.defaultTemplatePage,\n    searchedRecordPage: state.Interface.searchedRecordPage,\n    searchedTemplatePage: state.Interface.searchedTemplatePage,\n    defaultRecordKeys: state.Explorer.defaultRecordKeys,\n    defaultTemplateKeys: state.Explorer.defaultTemplateKeys,\n    searchedRecordKeys: state.Explorer.searchedRecordKeys,\n    searchedTemplateKeys: state.Explorer.searchedTemplateKeys,\n    recordsFetching: state.Explorer.recordsFetching,\n    recordsSuccess: state.Explorer.recordsSuccess,\n    recordsError: state.Explorer.recordsError,\n    templatesFetching: state.Explorer.templatesFetching,\n    templatesSuccess: state.Explorer.templatesSuccess,\n    templatesError: state.Explorer.templatesError,\n    showOnlyVerifiedPublishers: state.Interface.showOnlyVerifiedPublishers\n  }\n}\n\nconst mapDispatchToProps = {\n  setMode,\n  searchRecords,\n  searchTemplates,\n  publishRecord,\n  publishTemplate,\n  extendTemplates\n}\n\nExplorerContainer.propTypes = {\n  daemonApi: PropTypes.object.isRequired,\n  setMode: PropTypes.func.isRequired,\n  searchRecords: PropTypes.func.isRequired,\n  searchTemplates: PropTypes.func.isRequired,\n  defaultRecords: PropTypes.object,\n  defaultTemplates: PropTypes.object,\n  searchedRecords: PropTypes.object,\n  searchedTemplates: PropTypes.object,\n  mode: PropTypes.string.isRequired,\n  defaultRecordPage: PropTypes.number,\n  defaultTemplatePage: PropTypes.number,\n  searchedRecordPage: PropTypes.number,\n  searchedTemplatePage: PropTypes.number,\n  defaultRecordKeys: PropTypes.array,\n  defaultTemplateKeys: PropTypes.array,\n  searchedRecordKeys: PropTypes.array,\n  searchedTemplateKeys: PropTypes.array,\n  recordsFetching: PropTypes.bool,\n  recordsSuccess: PropTypes.bool,\n  recordsError: PropTypes.bool,\n  templatesFetching: PropTypes.bool,\n  templatesSuccess: PropTypes.bool,\n  templatesError: PropTypes.bool,\n  publishRecord: PropTypes.func.isRequired,\n  publishTemplate: PropTypes.func.isRequired,\n  extendTemplates: PropTypes.func.isRequired\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ExplorerContainer)\n"]},"metadata":{},"sourceType":"module"}